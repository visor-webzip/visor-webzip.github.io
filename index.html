<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title data-i18n="page.title">Visor Web-ZIP</title>
  <link rel="icon" href="favicon.svg" type="image/svg+xml">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Libre+Franklin:wght@400;600;800&family=Spectral:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>

  <div class="loading-screen" data-loading hidden>
    <div class="loading-card">
      <div class="loading-title" data-i18n="loading.title">Cargando material</div>
      <div class="loading-message" data-loading-message data-i18n="loading.message" data-i18n-dynamic>Preparando...</div>
      <div class="loading-bar">
        <div class="loading-bar__fill" data-loading-bar></div>
      </div>
      <div class="loading-note" data-i18n="loading.note">Este proceso puede tardar unos segundos la primera vez.</div>
    </div>
  </div>
  <main data-main>
    <header>
      <div class="title-row">
        <img class="app-mark" src="favicon.svg" alt="" aria-hidden="true">
        <div class="title-stack">
          <h1 data-i18n="header.title">Visor Web-ZIP</h1>
          <p class="header-subtitle" data-i18n="header.subtitle">Comparte tus recursos educativos desde tu almacenamiento favorito en la nube.</p>
        </div>
        <div class="title-actions">
          <div class="lang-switch">
            <label for="lang-select" class="sr-only" data-i18n="lang.label">Idioma</label>
            <select id="lang-select" data-lang-select>
              <option value="es" data-i18n="lang.es">Español</option>
              <option value="ca" data-i18n="lang.ca">Català</option>
              <option value="gl" data-i18n="lang.gl">Galego</option>
              <option value="eu" data-i18n="lang.eu">Euskara</option>
              <option value="en" data-i18n="lang.en">English</option>
              <option value="de" data-i18n="lang.de">Deutsch</option>
            </select>
          </div>
          <button class="help-pill" type="button" data-about-open data-i18n-aria-label="header.help">
            <span class="help-pill__icon">?</span>
            <span class="help-pill__tooltip" role="tooltip" data-i18n="header.help">Ayuda</span>
          </button>
        </div>
      </div>
    </header>

    <div class="tabs" role="tablist" aria-label="Secciones" data-i18n-aria-label="tabs.label">
      <button class="tab-button is-active" type="button" role="tab" aria-selected="true" data-tab="zipper" data-i18n="tab.zipper">1. Crear ZIP</button>
      <button class="tab-button" type="button" role="tab" aria-selected="false" data-tab="main" data-i18n="tab.main">2. Compartir recurso</button>
      <button class="tab-button" type="button" role="tab" aria-selected="false" data-tab="manager" data-i18n="tab.manager">Gestor de recursos</button>
    </div>

    <section class="tab-panel" role="tabpanel" data-tab-panel="main">
      <p class="manager-subtitle" data-i18n="main.subtitle">Para compartir tu recurso debes haberlo subido a Internet (Drive, Dropbox, etc.) en formato ZIP y compartirlo para que todo el mundo pueda verlo.</p>
      <form data-form>
        <span class="field-title" data-i18n="main.form.title">Pega aqui el enlace publico</span>
        <p class="step-note" data-i18n="main.form.step">Paso 1: pega el enlace público al ZIP y pulsa “Crear enlace”.</p>
        <input data-url type="url" placeholder="Pega aqui el enlace publico del ZIP" data-i18n-placeholder="main.form.placeholder" required>
        <button type="submit" data-i18n="main.form.submit">Crear enlace</button>
      </form>

      <div class="output-row">
        <div class="output-group" data-step-three>
          <span class="field-title" data-i18n="main.output.title">Enlace para compartir</span>
          <p class="step-note" data-i18n="main.output.step">Paso 2: copia el enlace o abre la vista previa.</p>
          <section class="output" data-output data-i18n="main.output.placeholder" data-i18n-dynamic>Enlace para compartir</section>
        </div>
        <div class="actions">
          <button type="button" data-copy disabled data-i18n="main.output.copy">Copiar enlace</button>
          <a class="open-link" data-open href="#" target="_blank" rel="noopener" aria-disabled="true" data-i18n="main.output.open">Abrir vista previa</a>
        </div>
      </div>
    </section>

    <section class="tab-panel" role="tabpanel" data-tab-panel="manager">
      <div class="manager-card">
        <div class="manager-header">
          <div>
            <h2 data-i18n="manager.title">Recursos guardados</h2>
            <p class="manager-subtitle" data-i18n="manager.subtitle">Gestiona el espacio que ocupan los materiales guardados en este navegador.</p>
          </div>
        </div>
        <div class="manager-stats">
          <div class="stat">
            <span class="stat-label" data-i18n="manager.stats.used">Espacio usado</span>
            <span class="stat-value" data-storage-used>0 MB</span>
            <span class="stat-note" data-storage-used-percent>--</span>
          </div>
          <div class="stat">
            <span class="stat-label" data-i18n="manager.stats.total">Espacio total</span>
            <span class="stat-value" data-storage-total>--</span>
          </div>
          <div class="stat">
            <span class="stat-label" data-i18n="manager.stats.count">Recursos guardados</span>
            <span class="stat-value" data-storage-count>0</span>
          </div>
        </div>
        <div class="manager-settings" data-manager-settings>
          <div class="setting-card">
            <div>
              <span class="stat-label" data-i18n="manager.settings.usage.label">Límite de uso antes de limpiar</span>
              <p class="setting-help" data-i18n="manager.settings.usage.help">Si se supera este porcentaje de la cuota, se borran los recursos más antiguos.</p>
            </div>
            <div class="setting-control">
              <input type="range" min="40" max="95" step="5" value="70" data-cleanup-threshold>
              <span class="setting-value"><span data-cleanup-threshold-value>70</span>%</span>
            </div>
          </div>
          <div class="setting-card">
            <div>
              <span class="stat-label" data-i18n="manager.settings.days.label">Días para borrar recursos antiguos</span>
              <p class="setting-help" data-i18n="manager.settings.days.help">Si un recurso no se abre en este periodo, se eliminará automáticamente.</p>
            </div>
            <div class="setting-control">
              <input type="number" min="7" max="365" step="1" value="30" data-cleanup-days>
              <span class="setting-suffix" data-i18n="manager.settings.days.suffix">días</span>
            </div>
          </div>
        </div>
        <div class="manager-toolbar">
          <div class="manager-toolbar__left">
            <button class="ghost-button ghost-button--small" type="button" data-reset-cleanup data-i18n="manager.settings.reset" data-i18n-tooltip="manager.settings.resetHelp">Restaurar valores por defecto</button>
            <button class="ghost-button ghost-button--small" type="button" data-delete-all data-i18n="manager.deleteAll" data-i18n-tooltip="manager.deleteAllHelp">Eliminar todos los recursos</button>
          </div>
          <div class="manager-toolbar__right">
            <span class="stat-label" data-i18n="manager.sort.label">Ordenar por</span>
            <select class="manager-sort" data-manager-sort>
              <option value="title" data-i18n="manager.sort.title">Título</option>
              <option value="date" data-i18n="manager.sort.date">Fecha</option>
              <option value="size" data-i18n="manager.sort.size">Tamaño</option>
            </select>
            <button class="ghost-button ghost-button--small manager-sort-dir" type="button" data-manager-sort-dir data-i18n-tooltip="manager.sort.dirHelp" aria-label="Orden ascendente/descendente">↑</button>
          </div>
        </div>
        <div class="manager-list" data-manager-list></div>
      </div>
    </section>

    <section class="tab-panel is-active" role="tabpanel" data-tab-panel="zipper">
      <div class="manager-card">
        <div class="manager-header">
          <div>
            <h2 data-i18n="zipper.title">Crear ZIP para el visor</h2>
            <ul class="manager-subtitle zipper-subtitle">
              <li data-i18n="zipper.subtitle.lead">Para compartir tu recurso, comprime los archivos (o la carpeta que los contiene) en un archivo .zip.</li>
              <li>
                <span data-i18n-html="zipper.subtitle.exeSentenceHtml">Si usas <strong>eXeLearning</strong>, también puedes crear el ZIP desde el propio programa y pasar directamente a la siguiente pestaña.</span>
                <button class="info-dot" type="button" data-i18n-aria-label="zipper.exe.tooltip">
                  ?
                  <span class="info-dot__tooltip" role="tooltip" data-i18n-html="zipper.exe.tooltipHtml">Cómo exportar desde eXeLearning:<br>• Versión 2.x: Archivo &gt; Exportar &gt; Sitio Web &gt; Archivo comprimido ZIP.<br>• Versión 3.x: Archivo &gt; Descargar como &gt; Sitio web.</span>
                </button>
              </li>
            </ul>
          </div>
        </div>
        <details class="html-zip-accordion">
          <summary class="html-zip-accordion__summary" data-i18n="zipper.html.title">¿No tienes archivos? Pega el HTML</summary>
          <div class="html-zip-card">
            <div class="html-zip-card__header">
              <p class="step-note" data-i18n-html="zipper.html.note">Pega el HTML completo y el visor creará un ZIP con un <code>index.html</code> listo para descargar.</p>
            </div>
            <textarea class="html-zip-textarea" data-html-zip-input data-i18n-placeholder="zipper.html.placeholder" placeholder="&lt;!doctype html&gt;..."></textarea>
            <div class="upload-actions">
              <button type="button" data-html-zip-build data-i18n="zipper.html.build">Crear ZIP desde HTML</button>
            </div>
            <p class="upload-status" data-html-zip-status data-i18n="zipper.html.status.ready" data-i18n-dynamic>Listo para crear el ZIP desde tu HTML.</p>
          </div>
        </details>
        <details class="html-zip-accordion">
          <summary class="html-zip-accordion__summary" data-i18n="zipper.accordion.filesTitle">¿Tienes archivos? Crea el ZIP</summary>
          <div class="upload-grid">
            <section class="upload-card">
              <h3 data-i18n="zipper.step1.title">1. Añade tus archivos</h3>
              <p class="step-note" data-i18n="zipper.step1.note">Paso 1: arrastra la carpeta o selecciona los archivos desde el botón.</p>
              <p class="upload-note" data-i18n="zipper.step1.detail">Puedes arrastrar una carpeta o archivos. También puedes seleccionar una carpeta completa desde el botón.</p>
              <div class="dropzone" data-dropzone>
                <div class="dropzone__title" data-i18n="zipper.dropzone.title">Arrastra aquí la carpeta o los archivos</div>
                <div class="dropzone__hint" data-i18n="zipper.dropzone.hint">Se respetan las carpetas internas.</div>
                <div class="dropzone__actions">
                  <button class="ghost-button" type="button" data-folder-button data-i18n="zipper.dropzone.folder">Elegir carpeta</button>
                  <button class="ghost-button" type="button" data-file-button data-i18n="zipper.dropzone.files">Elegir archivos</button>
                  <input type="file" data-folder-input webkitdirectory multiple hidden>
                  <input type="file" data-file-input multiple hidden>
                </div>
              </div>
              <p class="upload-status" data-upload-status data-i18n="zipper.status.empty" data-i18n-dynamic>No hay archivos seleccionados.</p>
            </section>
            <section class="upload-card">
              <h3 data-i18n="zipper.step2.title">2. Descarga el ZIP</h3>
              <p class="step-note" data-i18n="zipper.step2.note">Paso 2: crea el ZIP y se descargará automáticamente.</p>
              <p class="upload-note" data-i18n="zipper.step2.detail">Al crear el ZIP se descargará un archivo que puedes subir a Drive, Dropbox, Nextcloud, etc.</p>
              <div class="upload-actions">
                <button type="button" data-build-zip data-i18n="zipper.build">Crear y descargar ZIP</button>
              </div>
              <p class="upload-status" data-zip-status data-i18n="zipper.status.readyHint" data-i18n-dynamic>Prepara el ZIP para obtener tu archivo.</p>
            </section>
          </div>
        </details>
        <details class="html-zip-accordion">
          <summary class="html-zip-accordion__summary" data-i18n="zipper.help.title">Ya tengo el ZIP ¿Qué hago con él?</summary>
          <div class="upload-help">
            <ol>
              <li data-i18n="zipper.help.step1">Sube el ZIP a un servicio con enlace público (Drive, Dropbox, GitHub…).</li>
              <li data-i18n="zipper.help.step2">Copia el enlace público y pégalo en la pestaña siguiente.</li>
            </ol>
            <div class="upload-actions">
              <button class="ghost-button" type="button" data-go-tab="main" data-i18n="zipper.help.goTab">Ir a Compartir recurso</button>
            </div>
          </div>
        </details>
      </div>
    </section>

    <div class="modal" data-html-modal hidden>
      <div class="modal__overlay" data-html-close></div>
      <div class="modal__card" role="dialog" aria-modal="true" aria-labelledby="html-title">
        <div class="modal__header">
          <h2 id="html-title" data-i18n="html.title">Elige el HTML inicial</h2>
          <button class="modal__close" type="button" data-html-close data-i18n-aria-label="common.close">×</button>
        </div>
        <div class="modal__content">
          <p class="manager-subtitle" data-i18n="html.subtitle">No se encontró un index.html. Selecciona el archivo HTML que quieres abrir primero.</p>
          <div class="html-picker" data-html-list></div>
          <div class="html-picker__actions">
            <button class="ghost-button" type="button" data-html-close data-i18n="common.cancel">Cancelar</button>
            <button type="button" data-html-confirm data-i18n="html.confirm">Usar este HTML</button>
          </div>
        </div>
      </div>
    </div>

    <div class="modal" data-about-modal hidden>
      <div class="modal__overlay" data-about-close></div>
      <div class="modal__card" role="dialog" aria-modal="true" aria-labelledby="about-title">
        <div class="modal__header">
          <h2 id="about-title" data-i18n="about.title">¿Qué hace este visor?</h2>
          <button class="modal__close" type="button" data-about-close data-i18n-aria-label="common.close">×</button>
        </div>
        <div class="modal__content">
          <div class="about-guide" data-i18n-html="about.body">
            <p>Este visor abre un ZIP que contiene una web sencilla con HTML, CSS, imágenes, vídeos, audio y enlaces internos para que puedas compartirla con tu alumnado sin instalar nada.</p>
          </div>
        </div>
      </div>
    </div>

    <footer class="site-footer">
      <a class="footer-link" href="https://bilateria.org" target="_blank" rel="noopener">(c) 2026 Juan Jose de Haro</a>
      <span class="footer-sep">·</span>
      <span class="footer-link">v1.1.5</span>
      <span class="footer-sep">·</span>
      <a class="footer-link" href="https://github.com/visor-webzip/visor-webzip.github.io" target="_blank" rel="noopener">
        <svg class="footer-icon" viewBox="0 0 16 16" aria-hidden="true" focusable="false">
          <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82A7.62 7.62 0 0 1 8 4.77c.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.01 8.01 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
        </svg>
        GitHub
      </a>
      <span class="footer-sep">·</span>
      <a class="footer-link" href="https://www.gnu.org/licenses/agpl-3.0.html" target="_blank" rel="noopener">AGPLv3</a>
    </footer>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/fflate@0.8.2/umd/index.js"></script>
  <script src="config.js"></script>
  <script src="app.js?v=9"></script>
</body>
</html>
